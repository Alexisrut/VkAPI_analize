# VkAPI_analize
# VK Data Analysis Tool

## Описание
Этот код представляет собой набор функций для работы с данными из социальной сети ВКонтакте (VK). Он включает инструменты для получения, фильтрации и анализа данных о постах, комментариях, лайках и изображениях. Включены функции анализа текста, изображений и метаданных постов.

---

## Импортируемые библиотеки

```python
import requests
import time
import pickle
import datetime
import json
import pandas as pd
import os
import cv2
import numpy as np
from PIL import Image
from torchvision import models, transforms
from transformers import pipeline
import easyocr
from matplotlib import pyplot as plt
import seaborn as sns
import re
```

### Основные модули:
- **requests**: Для выполнения HTTP-запросов к API VK.
- **time**: Для контроля задержек при вызовах API.
- **cv2 и numpy**: Для обработки изображений.
- **torchvision.models**: Для использования моделей компьютерного зрения.
- **easyocr**: Для извлечения текста из изображений.
- **transformers**: Для работы с языковыми моделями.
- **pandas**: Для структурирования и анализа данных.
- **json**: Для работы с JSON-данными.

---

## Функции анализа изображений

### 1. `detect_text(image_path)`
**Описание:** Определяет наличие текста на изображении с использованием EasyOCR.

- **Аргументы:**
  - `image_path` (str): Путь к изображению.
- **Возвращает:**
  - `1`, если текст найден.
  - `0`, если текст отсутствует.

### 2. `detect_people(image_path)`
**Описание:** Определяет наличие людей на изображении, используя предобученную модель Faster R-CNN.

- **Аргументы:**
  - `image_path` (str): Путь к изображению.
- **Возвращает:**
  - `1`, если люди найдены.
  - `0`, если их нет.

### 3. `detect_objects(image_path)`
**Описание:** Выделяет основные объекты на изображении, сопоставляя их с классами COCO.

- **Аргументы:**
  - `image_path` (str): Путь к изображению.
- **Возвращает:**
  - Список обнаруженных объектов.

### 4. `calculate_colorfulness(image_path)`
**Описание:** Оценивает "красочность" изображения.

- **Аргументы:**
  - `image_path` (str): Путь к изображению.
- **Возвращает:**
  - Индекс красочности от 1 до 10.

---

## Работа с текстом

### 5. `llama_request(prompt)`
**Описание:** Отправляет запрос к языковой модели Llama и возвращает результат.

- **Аргументы:**
  - `prompt` (str): Текст запроса.
- **Возвращает:**
  - Результат выполнения запроса (str).

### 6. `analyze_post(post_text)`
**Описание:** Анализирует текст поста по следующим параметрам:
  - Тематика.
  - Структура (количество слов, абзацев, заголовков).
  - Язык и стиль (тональность, сложность).

- **Аргументы:**
  - `post_text` (str): Текст поста.
- **Возвращает:**
  - Словарь с результатами анализа.

---

## Работа с VK API

### 7. `getjson(url, data=None)`
**Описание:** Выполняет GET-запрос и возвращает результат в формате JSON.

- **Аргументы:**
  - `url` (str): URL для запроса.
  - `data` (dict): Параметры запроса.
- **Возвращает:**
  - Данные в формате JSON.

### 8. `get_all_posts(access_token, owner_id, count=500, offset=0)`
**Описание:** Получает все посты со стены сообщества или пользователя.

- **Аргументы:**
  - `access_token` (str): Токен доступа к VK API.
  - `owner_id` (str): ID владельца стены.
  - `count` (int): Количество постов за один запрос.
  - `offset` (int): Смещение для пагинации.
- **Возвращает:**
  - Список всех постов.

### 9. `filter_data(all_posts)`
**Описание:** Фильтрует посты, извлекая текст, лайки, комментарии и изображения.

- **Аргументы:**
  - `all_posts` (list): Список всех постов.
- **Возвращает:**
  - Отфильтрованный список постов.

### 10. `get_all_liked_lists(access_token, owner_id, liked_object_id, ...)`
**Описание:** Получает список пользователей, которые лайкнули указанный объект.

- **Аргументы:**
  - `access_token` (str): Токен доступа к VK API.
  - `owner_id` (str): ID владельца объекта.
  - `liked_object_id` (str): ID объекта.
- **Возвращает:**
  - Количество лайков и список пользователей.

---

## Основной код

Пример использования:

```python
if __name__ == "__main__":
    image_path = "path/to/image.jpg"
    post_text = "..."

    # Анализ изображения
    has_text = detect_text(image_path)
    colorfulness = calculate_colorfulness(image_path)

    # Анализ текста
    analysis = analyze_post(post_text)

    # Вывод результатов
    print(f"Текст найден: {has_text}")
    print(f"Красочность: {colorfulness}")
    print(analysis)
